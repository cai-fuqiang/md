Q: 大佬们，请教个问题：一个vm_area_struct中所有匿名页共用相同的anon_vma，但在
anon_vma_chain中用same_vma记录同一VMA的所有anon_vma。什么时候VMA会有多个anon_vma
的情况发生啊

A: hi~ 简单走读了下相关资料（还未仔细看源码), 还请辩证看
   如果有什么不对的地方, 还请大佬们帮忙指出..

   您提到的这个问题似乎是 anon_vma_chain 引入的原因。举个不太恰当的例子. 

   想象一个江湖门派(其中有师傅，我). 并且把具体的匿名页(page)想象成，具体的
   武功.

   我和师傅掌握的武功包括:

   师傅:
   * 腿法: 十六路谭腿
   * 掌法: 祥龙十八掌

   我:
   * 腿法: 十六路谭腿
   * 掌法: 祥龙十  巴 掌
   * 身法: 凌波微步

   我会的武功分为以下几种:
   1. 学习师傅的: 腿法(uncowed anon page)
   2. 我学习师傅的过程中，自己改进的: 掌法(cowed anon page)
   3. 我自己领悟的: 身法（new alloc anon page)

   （另外门派有个不成文的规定，师傅不能学习徒弟改进，领悟的武功，
   因为怕教会师傅，饿死徒弟）

   某天，门派掌门人想调查, 有哪些人掌握了哪些具体的功法:

   最初的做法是, 找了几个箱子，每个箱子代表一种武功,  让大家将名字写到纸
   上, 然后将纸投递到自己会的武功的箱子中，然后统计到一半时，发现纸没了, 
   用光了(这就相当于原始的pte_chain)

   然后门派掌门人想出了一个省纸的方法, 每个人把人名和会的武功写到一张纸上:
   于是大家写的格式是:
   * 张三: 腿法:xxx, 功法:xxx, 身法:xxx
   * 李四: 腿法:xxx, 功法:xxx, 身法: ???

   门派掌门人查找的时候立马就懵逼了. 得遍历所有的人才能把会该武功的人都找到.
   (这就是原始的anon_vma)

   于是，门派掌门人该进了下，方法.

   准备一些纸，让大家按照长辈高低，依次写出自己会的武功, 并签上自己的名字.

   例如:
   * 腿法:aaa, 功法:aaa 身法:aaa 
     张三

   然后，李四发现和张三会的功法一样, 就写:

   让后辈们写的时候，先找自己从师傅(或者师爷）学习并未改进的武功，并在后面签上自
   己的名字。然后再像长辈们一样，在拿一张新纸, 写上自己领悟或者改进武功.

   这样，门派领导人在查找的时候, 就很方便

1. https://lwn.net/Articles/383162/
