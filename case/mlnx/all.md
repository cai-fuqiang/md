# 中信RPM包链接
## 公共包 -- 611 621 都需要安装

|包名|版本|koji build|public x86|public arm64|
|---|---|---|---|---|
|libnl3-devel|3.5.0-1.es8|[link][libnl3-3.5.0-1.es8]|[link][libnl3-devel_x86]|[link][libnl3-devel_arm64]|
|infiniband-diags|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][infiniband-diags_x86]|[link][infiniband-diags_arm64]|
|libibumad|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][libibumad_x86]|[link][libibumad_arm64]|
|libibverbs|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][libibverbs_x86]|[link][libibverbs_arm64]|
|libibverbs-utils|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][libibverbs-utils_x86]|[link][libibverbs-utils_arm64]|
|librdmacm|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][librdmacm_x86]|[link][librdmacm_arm64]|
|librdmacm-utils|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][librdmacm-utils_x86]|[link][librdmacm-utils_arm64]|
|rdma-core|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][rdma-core_x86]|[link][rdma-core_arm64]|
|rdma-core-devel|58mlnx43-1.es8.58112|[link][rdma-core-58mlnx43-1.es8.58112]|[link][rdma-core-devel_x86]|[link][rdma-core-devel_arm64]|
|mlnx-tools|5.2.0-0.58112|[link][mlnx-tools-5.2.0-0.58112]|[link][mlnx-tools_x86]|[link][mlnx-tools_arm64]|

<!--RPM LINK -->
[infiniband-diags_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/infiniband-diags-58mlnx43-1.es8.58112.x86_64.rpm
[infiniband-diags_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/infiniband-diags-58mlnx43-1.es8.58112.aarch64.rpm
[libibumad_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/libibumad-58mlnx43-1.es8.58112.x86_64.rpm
[libibumad_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/libibumad-58mlnx43-1.es8.58112.aarch64.rpm
[libibverbs_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/libibverbs-58mlnx43-1.es8.58112.x86_64.rpm
[libibverbs_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/libibverbs-58mlnx43-1.es8.58112.aarch64.rpm
[libibverbs-utils_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/libibverbs-utils-58mlnx43-1.es8.58112.x86_64.rpm
[libibverbs-utils_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/libibverbs-utils-58mlnx43-1.es8.58112.aarch64.rpm
[librdmacm_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/librdmacm-58mlnx43-1.es8.58112.x86_64.rpm
[librdmacm_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/librdmacm-58mlnx43-1.es8.58112.aarch64.rpm
[librdmacm-utils_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/librdmacm-utils-58mlnx43-1.es8.58112.x86_64.rpm
[librdmacm-utils_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/librdmacm-utils-58mlnx43-1.es8.58112.aarch64.rpm
[rdma-core_x86]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/rdma-core-58mlnx43-1.es8.58112.x86_64.rpm
[rdma-core_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/rdma-core-58mlnx43-1.es8.58112.aarch64.rpm
[rdma-core-devel_x86]:  http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/x86_64/rdma-core-devel-58mlnx43-1.es8.58112.x86_64.rpm
[rdma-core-devel_arm64]: http://koji.easystack.io/kojifiles/packages/rdma-core/58mlnx43/1.es8.58112/aarch64/rdma-core-devel-58mlnx43-1.es8.58112.aarch64.rpm

<!-- RPM LINK -->
[libnl3-devel_x86]: http://koji.easystack.io/kojifiles/packages/libnl3/3.5.0/1.es8/x86_64/libnl3-devel-3.5.0-1.es8.x86_64.rpm
[libnl3-devel_arm64]: http://koji.easystack.io/kojifiles/packages/libnl3/3.5.0/1.es8/aarch64/libnl3-devel-3.5.0-1.es8.aarch64.rpm

[mlnx-tools_x86]: http://koji.easystack.io/kojifiles/packages/mlnx-tools/5.2.0/0.58112/x86_64/mlnx-tools-5.2.0-0.58112.x86_64.rpm
[mlnx-tools_arm64]: http://koji.easystack.io/kojifiles/packages/mlnx-tools/5.2.0/0.58112/aarch64/mlnx-tools-5.2.0-0.58112.aarch64.rpm

<!-- koji BUILD -->
[libnl3-3.5.0-1.es8]: http://koji.easystack.io/buildinfo?buildID=1634
[rdma-core-58mlnx43-1.es8.58112]: http://koji.easystack.io/buildinfo?buildID=4074

[mlnx-tools-5.2.0-0.58112]: http://koji.easystack.io/buildinfo?buildID=4075
## 621

|包名|版本|koji build|621-x86|621-arm64|
|---|---|---|---|---|
|mlnx-ofa_kernel|5.8-1.1.2.1.es8_7.k372       |[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_7.k372]|[link][mlnx-ofa_kernel_621_x86]|[link][mlnx-ofa_kernel_621_arm64]|
|kmod-mlnx-ofa_kernel|5.8-1.1.2.1.es8_7.k372  |[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_7.k372]|[link][kmod-mlnx-ofa_kernel_621_x86]|[link][kmod-mlnx-ofa_kernel_621_arm64]|
|mlnx-ofa_kernel-devel|5.8-1.1.2.1.es8_7.k372 |[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_7.k372]|[link][mlnx-ofa_kernel-devel-621_x86]|[link][mlnx-ofa_kernel-devel-621_arm64]|
|kmod-mlnx-nvme|5.8-1.1.1.1.es8_3.k372        |[link][kmod-mlnx-nvme-kmodtool-5.8-1.1.1.1.es8_3.k372]|[link][kmod-mlnx-nvme_621_x86]|[link][kmod-mlnx-nvme_621_arm64]|

<!-- RPM LINK -->
[mlnx-ofa_kernel_621_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/x86_64/mlnx-ofa_kernel-5.8-1.1.2.1.es8_7.k372.x86_64.rpm
[mlnx-ofa_kernel_621_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/aarch64/mlnx-ofa_kernel-5.8-1.1.2.1.es8_7.k372.aarch64.rpm

[kmod-mlnx-ofa_kernel_621_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/x86_64/kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_7.k372.x86_64.rpm
[kmod-mlnx-ofa_kernel_621_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/aarch64/kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_7.k372.aarch64.rpm

[mlnx-ofa_kernel-devel-621_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/x86_64/mlnx-ofa_kernel-devel-5.8-1.1.2.1.es8_7.k372.x86_64.rpm
[mlnx-ofa_kernel-devel-621_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_7.k372/aarch64/mlnx-ofa_kernel-devel-5.8-1.1.2.1.es8_7.k372.aarch64.rpm


[kmod-mlnx-nvme_621_x86]: http://koji.easystack.io/kojifiles/work/tasks/4504/34504/kmod-mlnx-nvme-5.8-1.1.1.1.es8_3.k372.x86_64.rpm
[kmod-mlnx-nvme_621_arm64]: http://koji.easystack.io/kojifiles/work/tasks/4505/34505/kmod-mlnx-nvme-5.8-1.1.1.1.es8_3.k372.aarch64.rpm


<!-- koji BUILD -->
[kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_7.k372]: http://koji.easystack.io/buildinfo?buildID=4311
[kmod-mlnx-nvme-kmodtool-5.8-1.1.1.1.es8_3.k372]: http://koji.easystack.io/buildinfo?buildID=4312

## 611 
|包名|版本|koji build|611-x86|611-arm64|
|---|---|---|---|---|
|mlnx-ofa_kernel|5.8-1.1.2.1.es8_8.k147|[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_8.k147]|[link][mlnx-ofa_kernel_611_x86]|[link][mlnx-ofa_kernel_611_arm64]|
|kmod-mlnx-ofa_kernel|5.8-1.1.2.1.es8_8.k147|[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_8.k147]|[link][kmod-mlnx-ofa_kernel_611_x86]|[link][kmod-mlnx-ofa_kernel_611_arm64]|
|mlnx-ofa_kernel-devel|5.8-1.1.2.1.es8_8.k147|[link][kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_8.k147]|[link][mlnx-ofa_kernel-devel_611_x86]|[link][mlnx-ofa_kernel-devel_611_arm64]|
|kmod-mlnx-nvme-OFED|5.8-1.1.1.1.es8_4.k147|[link][kmod-mlnx-nvme-kmodtool-5.8-1.1.1.1.es8_4.k147]|[link][kmod-mlnx-nvme_611_x86]|[link][kmod-mlnx-nvme_611_arm64]|

<!-- RPM LINK -->
[mlnx-ofa_kernel_611_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/x86_64/mlnx-ofa_kernel-5.8-1.1.2.1.es8_8.k147.x86_64.rpm
[mlnx-ofa_kernel_611_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/aarch64/mlnx-ofa_kernel-5.8-1.1.2.1.es8_8.k147.aarch64.rpm
[kmod-mlnx-ofa_kernel_611_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/x86_64/kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_8.k147.x86_64.rpm
[kmod-mlnx-ofa_kernel_611_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/aarch64/kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_8.k147.aarch64.rpm
[mlnx-ofa_kernel-devel_611_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/x86_64/mlnx-ofa_kernel-devel-5.8-1.1.2.1.es8_8.k147.x86_64.rpm
[mlnx-ofa_kernel-devel_611_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-ofa_kernel-kmodtool/5.8/1.1.2.1.es8_8.k147/aarch64/mlnx-ofa_kernel-devel-5.8-1.1.2.1.es8_8.k147.aarch64.rpm

[kmod-mlnx-nvme_611_x86]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-nvme-kmodtool/5.8/1.1.1.1.es8_4.k147/x86_64/kmod-mlnx-nvme-OFED-5.8-1.1.1.1.es8_4.k147.x86_64.rpm
[kmod-mlnx-nvme_611_arm64]: http://koji.easystack.io/kojifiles/packages/kmod-mlnx-nvme-kmodtool/5.8/1.1.1.1.es8_4.k147/aarch64/kmod-mlnx-nvme-OFED-5.8-1.1.1.1.es8_4.k147.aarch64.rpm

<!-- koji BUILD -->
[kmod-mlnx-ofa_kernel-kmodtool-5.8-1.1.2.1.es8_8.k147]: http://koji.easystack.io/buildinfo?buildID=6348
[kmod-mlnx-nvme-kmodtool-5.8-1.1.1.1.es8_4.k147]: http://koji.easystack.io/buildinfo?buildID=6349

> 611 NOTE
>
> 在装驱动包之前,需要执行, yum remove kmod-mlnx-ofa

> ALL WARN
>
> 1. 上面提供的具体包,和这些包的版本都是基于case中的comment列出, 并且611 上的驱动包是新编译的, 
>    和客户那边已经部署好的环境可能不同, 请运维同事之后统一下
> 2. 在安装驱动前如果有qla2xxx 环境, 请手动 通过 yum remove kmod-qla2xxx 卸载, 如果客户有对该驱动的需求,
>    请联系系统研发人员.
> 3. 部分老版本驱动卸载有问题, 请参照下一章节, 如果有在卸载过程中还遇到其他问题, 请及时联系
>    系统研发人员.


# 老版本驱动卸载可能存在的问题

如果在621/611环境, 遇到如下版本驱动, 请一定使用下面方式卸载!!

## 621环境

**kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_3**

执行下面命令卸载
```sh
#!/bin/sh
set -e
rpm -ql kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_3.$(uname -m) | grep '\.ko$'  \
                > /var/run/rpm-kmod-mlnx-ofa_kernel-modules

rpm -e kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_3.$(uname -m) --noscripts

modules=( $(cat /var/run/rpm-kmod-mlnx-ofa_kernel-modules) )
rm /var/run/rpm-kmod-mlnx-ofa_kernel-modules
if [ -x "/sbin/weak-modules" ]; then
    printf '%s\n' "${modules[@]}"     | /sbin/weak-modules --remove-modules
fi
```

## 611环境

**kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_2**

```sh
set -e
rpm -ql kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_2.$(uname -m) | grep '\.ko$' \
                        > /var/run/rpm-kmod-mlnx-ofa_kernel-modules
rpm -e kmod-mlnx-ofa_kernel-5.8-1.1.2.1.es8_2.$(uname -m) --noscripts

modules=( $(cat /var/run/rpm-kmod-mlnx-ofa_kernel-modules) )
rm /var/run/rpm-kmod-mlnx-ofa_kernel-modules
if [ -x "/sbin/weak-modules" ]; then
    printf '%s\n' "${modules[@]}"     | /sbin/weak-modules --remove-modules
fi
```
